- FIP: 15
- title: P2P Marketplaces with feeds
- author: @molekilla (Rogelio Morrell)
- status: draft
- created: 2022-06-22

# Summary

NFT marketplaces are mostly public, anyone can auction NFTs to buyers. Minting NFTs in certain use cases might required privacy. This draft document explains using Soulbound tokens (SBT) enabled with Swarm support as provenance and origin claims.

# Context and motivation
In a traditional NFT marketplaces, the user flow starts with the creator publishing assets to a decentralised content network, eg IPFS, Swarm, Arweave, etc. These assets are unprotected, and are linked only through the ERC-721 metadata schema (usually a JSON representation) to a tokenized representation in a specific chain (the most common is the ERC-721 token).

Many problems arise with common use cases like dynamic publishing, eg that depends on how rare a NFT asset is or that depends on a games outcome. Many obfuscation techniques are design and available as Solidity best practices or design patterns. These strategies might be difficult for developers to apply in practice, including pros and cons in smart contract security.

In this draft specification we come up with a technical architecture where Soulbound tokens are provenance claims for NFTs, these claims at the same containing private data which is hidden with ZKP Zero Knowledge Protocols.

# Guide-level explanation

A generalized NFT Marketplace implementation has the following

## NFT Minting
Here we start the user flow by requiring the NFT description, image or asset, and name, following ERC-721 standard. This can in turn be different depending the user case eg minting is done by an agent listening for onchain events to mint dynamic nfs.

In the P2P implementation, an additional `provenance claim` is minted as a SBT to the buyer of the NFT. Additional SBTs, eg `issuer` for the NFT publisher and `wholesaler` for the NFT marketplace can also be minted.

## My wallet or profile
This page contains the wallet, address and balances for an account. It also has a list of owned, purchased or listed NFTs.

## Listings
NFT are listed in a marketplace in listings categorized by genre. In a P2P marketplace, the listings are private and shared as a Swarm feed through a FDP Dapp (previously registered). Users can shared these private listings as feeds and the dapp manages the state of these listings.

## Purchase
Purchases in a typical marketplace consists of a Wholesaler (Marketplace) which gets a fee, a Publisher (Artist) who sells the artwork and a Buyer (User) who purchases the NFT. In most cases, a royalty is added to the NFT as incentive for the buyer when the artwork is sold in 2nd hand markets.

In a P2P marketplace, there is no need for a Wholesaler, so the commercial aspects is between producer and consumer. The downside is that there is no marketing for you NFTs, a P2P Marketplace use case is really for private auctions with VIP invitations or similar.

# Reference-level explanation

## Milestones

The tecnology stack to implement a P2P marketplace consists of:

## beezk - SBT Smart Contract Reference Implementation

`beezk` is a soulbound token smart contract reference implementation using Consensys [gnark](https://docs.gnark.consensys.net/en/latest/), which allows us to use ZK signatures with EVM Solidity smart contracts without registering additional private keys. 

Implementation must contain a set of claims using `beezk`, already described as

- `provenance claim` which attests for a proof of origin of a NFT metadata
- `publisher or issuer claim` which attests for proof of originator
- `wholesaler claim` which attests for a proof of allowed or certified wholesaler

These SBTs allows for a P2P marketplace to be transparent or trustless and avoids the need to have a database of certified wholesaler and verified NFT hashes.

## swarm feeds - streaming feeds feature

This allows for feeds to be like a YouTube video, you can skip to a point in time, forward to latest, or get the first feed chunk. 

## P2P marketplace smart contracts

The P2P Marketplace smart contracts must implement:

- NFT Contract, which provides an SBT verifier generated by `gnark`
- A Dapp /Blob Registry enabled smart contract, where the dapp is found
- A P2P Marketplace smart contract, which has no fees (no intermediary) and is similar to 1-inch P2P Swap

## P2P marketplace user interface

- Either NextJS (React) or NuxtJS (Vue) should be used to implement the frontend interface for the P2P Marketplace
- Must be FDP ready, either using `fdp-storage` or `blossom` for wallet integration

The reference implementation must be EVM agnostic, that is, can be deploy in any EVM and be able at the same time to support FDP/Swarm.


# Drawbacks

None

# Rationale and alternatives

None


# Prior art

None

## Copyright

Copyright and related rights waived via [CC0](https://creativecommons.org/publicdomain/zero/1.0/).
